# CVE-2022-3328：Snapd 本地权限提升漏洞通告

报告编号：B6-2022-120201

更新日期：2022-12-02

## 0x01  漏洞简述

2022年12月02日，360CERT监测发现`Snapd 本地权限提升漏洞`的漏洞细节在互联网公开，漏洞编号为`CVE-2022-3328`，漏洞等级：`高危`，漏洞评分：`7.8`。

Snap是Canonical为使用Linux内核的操作系统开发的软件打包和部署系统。

## 0x02  风险等级

该漏洞的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 高危 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 7.8  |

## 0x03  漏洞详情

### CVE-2022-3328: Snapd特权提升漏洞

CVE: CVE-2022-3328

组件: Snapd

漏洞类型: 特权提升

影响: 特权提升

简述: 该漏洞存在于snap-confine 的 must_mkdir_and_open_with_perms()中，是一个条件竞争漏洞，非特权用户可以结合另外两个统称为Leeloo Multipath的漏洞（CVE-2022-41974：multipath授权绕过漏洞 和 CVE-2022-41973：multipath符号链接漏洞）将 /tmp 目录绑定到文件系统中的任意目录，进而将普通用户权限提升至ROOT权限。

## 0x04  影响版本

| 组件  | 影响版本  | 安全版本  |
| ----- | --------- | --------- |
| snapd | < 2.57.6  | >= 2.57.6 |
| snapd | >= 2.54.3 | < 2.54.3  |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`.

可参考以下链接：

snapd

https://github.com/snapcore/snapd/releases

opensvc-tools

https://github.com/opensvc/multipath-tools/tags