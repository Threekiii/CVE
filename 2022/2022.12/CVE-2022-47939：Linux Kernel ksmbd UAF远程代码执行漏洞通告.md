# CVE-2022-47939：Linux Kernel ksmbd UAF远程代码执行漏洞通告

报告编号：B6-2022-122602

更新日期：2022-12-26

## 0x01  事件简述

2022年12月26日，360CERT监测发现`Linux Kernel ksmbd UAF远程代码执行漏洞`的漏洞细节在互联网公开，漏洞编号为`CVE-2022-47939`，漏洞等级：`严重`，漏洞评分：`10.0`。

Linux Kernel 是开源操作系统 Linux 所使用的内核。KSMBD 是一个 linux Kernel 服务器，它在内核空间中实现 SMB3 协议，用于通过网络共享文件。

## 0x02  风险等级

该事件的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 严重 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 10.0 |

## 0x03  漏洞详情

### CVE-2022-47939: Linux Kernel ksmbd UAF远程代码执行漏洞

CVE: CVE-2022-47939

组件: Kernel

漏洞类型: 代码执行

影响: 服务器接管

简述: 该漏洞存在于SMB2_TREE_DISCONNECT 命令的处理过程中，该漏洞是由于在对对象执行操作之前缺乏对对象的验证引起的，未经身份验证的远程攻击者可以在受影响的 Linux 内核上执行任意代码。只有启用 ksmbd 的系统才受该漏洞影响。

## 0x04  影响版本

| 组件         | 影响版本      | 安全版本                  |
| ------------ | ------------- | ------------------------- |
| Linux Kernel | 5.15 - 5.19.2 | 5.15.61、5.19.2或更高版本 |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`。