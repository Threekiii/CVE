# CVE-2025-6019：libblockdev 权限提升漏洞

## 0x01   漏洞简述

ibblockdev 是一个用于处理块设备操作的库，主要用于 Linux 系统中的存储管理。它提供了一系列工具和函数，用于管理磁盘分区、文件系统操作等，Udisks 则是 Linux 中的一个磁盘调度工具，其底层调用了 libblockdev。2025 年 6 月，互联网上披露 CVE-2025-6019 ibblockdev 权限提升漏洞，在具有服务器权限的前提下，若攻击者同时具有 allow_active 权限，那么可利用 udisks 和 ibblockdev 进一步提升权限。

影响范围：

```
3.3.x <= libblockdev < 3.3.1
3.2.x <= libblockdev < 3.2.2
2.x <= libblockdev < 2.30
```

安全版本：

```
libblockdev 3.2.2
libblockdev 2.30
libblockdev 3.3.1
```

## 0x02   风险等级

| 评定方式            | 等级  |
| --------------- | --- |
| 威胁等级            | 严重  |
| 影响面             | 广泛  |
| 攻击者价值           | 高   |
| 利用难度            | 高   |
| CVSS 4.0/3.x 评分 | 7.0 |

## 0x03   漏洞详情

### 披露时间

2025-06-19

### 参考链接

- http://www.openwall.com/lists/oss-security/2025/06/17/5
- http://www.openwall.com/lists/oss-security/2025/06/17/6
- http://www.openwall.com/lists/oss-security/2025/06/18/1
- https://access.redhat.com/security/cve/CVE-2025-6019
- https://blog.qualys.com/vulnerabilities-threat-research/2025/06/17/qualys-tru-uncovers-chained-lpe-suse-15-pam-to-full-root-via-libblockdev-udisks
- https://bugzilla.redhat.com/show_bug.cgi?id=2370051
- https://lists.debian.org/debian-lts-announce/2025/06/msg00018.html
- https://ubuntu.com/security/CVE-2025-6019

## 0x04   修复建议

### 通用修补建议

1. ibblockdev 通常为底层依赖包，通常由操作系统对其进行管理，并且有其自己的发行版本号。其实际修复版本依赖上游操作系统发布，而非 ibblockdev 官方发布版本。云安全中心将持续跟进各上游操作系统发行方安全通告，并及时上线对应漏洞检测与修复规则。
2. 缓解措施：修改 org.freedesktop.UDisks2.policy 中 allow_active 值从 yes 修改为 auth_admin。同时若无必要可临时关闭 udisks 服务，可执行 systemctl mask udisks2.service 或者 systemctl stop udisks2。
