# CVE-2025-53002：Llama-Factory vhead_file 代码执行漏洞

## 0x01   漏洞简述

LLaMA-Factory 是一个针对大型语言模型的调优库。CVE-2025-53002 中，在 LLaMA-Factory 训练过程时由于 `vhead_file` 参数在加载模型时没有增加 weights_only=True 选项，使得恶意攻击者可以通过 WebUI 界面传递“Checkpoint 路径”参数，从而在主机系统上执行任意的恶意代码。官方已经发布 0.9.4 版本修复该漏洞，建议升级至最新版本。

## 0x02   风险等级

| 评定方式            | 等级  |
| --------------- | --- |
| 威胁等级            | 高危  |
| 影响面             | 广泛  |
| 攻击者价值           | 高   |
| 利用难度            | 低   |
| CVSS 4.0/3.x 评分 | 8.9 |

## 0x03   漏洞详情

### 披露时间

2025-06-26

### 参考链接

- https://drive.google.com/file/d/1AddKm2mllsXfuvL4Tvbn_WJdjEOYXx4y/view?usp=sharing
- https://github.com/hiyouga/LLaMA-Factory/commit/bb7bf51554d4ba8432333c35a5e3b52705955ede
- https://github.com/hiyouga/LLaMA-Factory/security/advisories/GHSA-xj56-p8mm-qmxj

## 0x04   修复建议

### 通用修补建议

1. 官方已经发布 0.9.4 版本修复该漏洞，建议升级至最新版本。
2. 利用安全组设置 LLaMA-Factory WebUI 仅对可信地址开放。
