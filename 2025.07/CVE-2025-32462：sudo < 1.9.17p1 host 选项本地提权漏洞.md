# CVE-2025-32462：sudo < 1.9.17p1 host 选项本地提权漏洞

## 0x01   漏洞简述

sudo 是 Linux 系统发行版中的系统用户权限管理工具。2025 年 7 月，互联网上披露 CVE-2025-32462 sudo < 1.9.17p1 host 选项本地提权漏洞。攻击者在已经获取到本地权限的情况下，若此时 /etc/sudoers 定义的 Host 或 Host_Alias 过于宽松，则攻击者可结合 sudo 的 -h（--host）选项，造成权限提升以 root 身份执行命令。

sudo 影响范围：

```
1.9.0 <= sudo <= 1.9.17
1.8.8 <= sudo <= 1.8.32
```

sudo 安全版本：

```
sudo 1.9.17p1
```

## 0x02   风险等级

| 评定方式            | 等级       |
| --------------- | -------- |
| 威胁等级            | 高危       |
| 影响面             | 广泛       |
| 攻击者价值           | 高        |
| 利用难度            | 中（非默认配置） |
| CVSS 4.0/3.x 评分 | 7.4      |

## 0x03   漏洞详情

### 披露时间

2025-07-01

### 参考链接

- https://access.redhat.com/security/cve/cve-2025-32462
- https://bugs.gentoo.org/show_bug.cgi?id=CVE-2025-32462
- https://explore.alas.aws.amazon.com/CVE-2025-32462.html
- https://lists.debian.org/debian-security-announce/2025/msg00118.html
- https://security-tracker.debian.org/tracker/CVE-2025-32462
- https://ubuntu.com/security/notices/USN-7604-1
- https://www.openwall.com/lists/oss-security/2025/06/30/2
- https://www.secpod.com/blog/sudo-lpe-vulnerabilities-resolved-what-you-need-to-know-about-cve-2025-32462-and-cve-2025-32463/
- https://www.stratascale.com/vulnerability-alert-CVE-2025-32462-sudo-host
- https://www.sudo.ws/releases/changelog/
- https://www.sudo.ws/security/advisories/
- https://www.sudo.ws/security/advisories/host_any/
- https://www.suse.com/security/cve/CVE-2025-32462.html

## 0x04   修复建议

### 通用修补建议

目前 Ubuntu/Debian 官方已发布新版本修复补丁，用户可按照如下方案进行升级修复和验证：

#### 立即升级 Sudo（推荐）

```
# Ubuntu/Debian 系列用户：
sudo apt update && sudo apt install sudo -y 
dpkg -l sudo

# 验证修复（应显示1.9.15p5-3ubuntu5.24.04.1或更高版本）
sudo --version
```

```
# Fedora/CentOS/RHEL系列用户：
sudo dnf update sudo -y  

# 验证修复（目前官方暂未发布最新补丁，待发布升级到官方最新版本）
sudo --version
```

相关版本详见 Red Hat 官方公告：[cve-details](https://access.redhat.com/security/cve/CVE-2025-32463)。

#### 紧急缓解措施（临时）

```
# 移除所有用户的 chroot 权限
echo 'Defaults !chroot' | sudo tee /etc/sudoers.d/disable-chroot 
sudo chmod 440 /etc/sudoers.d/disable-chroot
```
