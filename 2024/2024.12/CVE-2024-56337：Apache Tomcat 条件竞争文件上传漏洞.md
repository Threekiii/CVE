# CVE-2024-56337：Apache Tomcat 条件竞争文件上传漏洞

## 0x01   漏洞简述

Apache Tomcat 是由 Apache 软件基金会下属的 Jakarta 项目开发的 Servlet 容器。2024 年 12 月，官方披露 CVE-2024-56337 Apache Tomcat 条件竞争文件上传漏洞。

在 CVE-2024-50379 中由于 Apache Tomcat 在路径校验逻辑中存在缺陷，当在不区分大小写的系统（如 Windows）上启用了 default servlet 的写入功能（默认关闭）时，攻击者可构造恶意请求绕过路径一致性检查，从而可能上传 webshell 并造成远程代码执行。由于 Apache Tomcat 官方在针对 CVE-2024-50379 的修复中不够全面，导致在不同 Java 版本的情况下可能存在绕过，12 月 20 日 Apache Tomcat 官方发布 CVE-2024-56337 进一步缓解该条件竞争文件上传漏洞。

影响范围：

```
11.0.0-M1 <= Apache Tomcat < 11.0.2
10.1.0-M1 <= Apache Tomcat < 10.1.34
9.0.0.M1 <= Apache Tomcat < 9.0.98
```

安全版本：

```
Apache Tomcat 11.0.2
Apache Tomcat 10.1.34
Apache Tomcat 9.0.98
```

## 0x02   风险等级

| 评定方式  | 等级  |
| ----- | --- |
| 威胁等级  | 高危  |
| 影响面   | 广泛  |
| 攻击者价值 | 高   |
| 利用难度  | 高   |
| 评分    | 8.9 |

## 0x03   漏洞详情

### 披露时间

2024-12-21

### 参考链接

- https://access.redhat.com/security/cve/CVE-2024-56337
- https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp
- https://security.netapp.com/advisory/ntap-20250103-0002/
- https://www.cve.org/CVERecord?id=CVE-2024-50379

## 0x04   修复建议

### 通用修补建议

1. 建议升级至安全版本及其之后。
2. 若无必要建议关闭 Default Servlet 的写入功能（设置 readonly 为 true）。
3. 云安全中心支持针对 Apache Tomcat default servlet PUT 开启风险 进行检测。
