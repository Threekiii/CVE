# CVE-2024-56145：Craft CMS register_argc_argv 模板注入代码执行漏洞

## 0x01   漏洞简述

Craft CMS 是一个灵活、用户友好的内容管理系统，用于创建自定义的数字化网络体验等。CVE-2024-56145 中，若开启了 PHP 配置中的 register_argc_argv，那么攻击者可构造恶意请求利用模版注入漏洞执行任意代码，控制服务器。

影响范围：

```
5.0.0-RC1 <= Craft CMS < 5.5.2
4.0.0-RC1 <= Craft CMS < 4.13.2
```

## 0x02   风险等级

| 评定方式  | 等级  |
| ----- | --- |
| 威胁等级  | 严重  |
| 影响面   | 广泛  |
| 攻击者价值 | 高   |
| 利用难度  | 低   |
| 评分    | 9.9 |

## 0x03   漏洞详情

### 披露时间

2024-12-19

### 参考链接

- https://github.com/craftcms/cms/commit/82e893fb794d30563da296bca31379c0df0079b3
- https://github.com/craftcms/cms/security/advisories/GHSA-2p6p-9rc9-62j9

## 0x04   修复建议

### 通用修补建议

1. 升级 Craft CMS 至安全版本
2. 设置 register_argc_argv 为 off
