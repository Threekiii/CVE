# CVE-2024-50379：Apache Tomcat 条件竞争文件上传漏洞

## 0x01   漏洞简述

Apache Tomcat 是由 Apache 软件基金会下属的 Jakarta 项目开发的 Servlet 容器。2024 年 12 月，官方披露 CVE-2024-50379 Apache Tomcat 条件竞争文件上传漏洞。

由于 Apache Tomcat 在路径校验逻辑中存在缺陷，当在不区分大小写的系统（如 Windows）上启用了 default servlet 的写入功能（默认关闭）时，攻击者可构造恶意请求绕过路径一致性检查，从而可能上传 webshell 并造成远程代码执行。漏洞利用需要条件竞争，对网络以及机器性能环境等有一定要求。

## 0x02   风险等级

| 评定方式  | 等级  |
| ----- | --- |
| 威胁等级  | 高危  |
| 影响面   | 广泛  |
| 攻击者价值 | 高   |
| 利用难度  | 高   |
| 评分    | 7.5 |

## 0x03   漏洞详情

### 披露时间

2024-12-17

### 参考链接

- http://www.openwall.com/lists/oss-security/2024/12/17/4
- https://access.redhat.com/security/cve/CVE-2024-50379
- https://avd.aliyun.com/detail/AVD-2024-1770267
- https://lists.apache.org/thread/y6lj6q1xnp822g6ro70tn19sgtjmr80r

## 0x04   修复建议

### 通用修补建议

1. 建议升级至安全版本。
2. 若无必要建议关闭 Default Servlet 的写入功能（设置 readonly 为 true）。
3. 云安全中心支持针对 Apache Tomcat default servlet PUT 开启风险 进行检测。
