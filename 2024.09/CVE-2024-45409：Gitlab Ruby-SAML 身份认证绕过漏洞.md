# CVE-2024-45409：Gitlab Ruby-SAML 身份认证绕过漏洞

## 0x01   漏洞简述

GitLab 是一个基于 Web 的 Git 仓库管理工具，它提供了代码仓库托管、代码审查、持续集成和持续部署等功能，支持团队协作开发。2024 年 9 月，Gitlab 官方披露 Gitlab SAML 身份认证绕过漏洞，官方评级严重。由于 Gitlab 使用 ruby-saml 和 omniauth-saml，而 Ruby-SAML 依赖存在 CVE-2024-45409 身份认证绕过漏洞，导致攻击者可构造恶意的 SAML，绕过 Gtilab 的身份认证，从而可以任何人的身份登陆 Gitlab。漏洞利用需要攻击者知道 Gitlab SAML 配置中的 IDP 相关信息。

安全版本：

```
17.3.3
17.2.7
17.1.8
17.0.8
16.11.10
```

## 0x02   风险等级

| 评定方式  | 等级  |
| ----- | --- |
| 威胁等级  | 高危  |
| 影响面   | 广泛  |
| 攻击者价值 | 高   |
| 利用难度  | 高   |
| 评分    | 7.5 |

## 0x03   漏洞详情

### 披露时间

2024-09-18

### 参考链接

- https://about.gitlab.com/releases/2024/09/17/patch-release-gitlab-17-3-3-released/

## 0x04   修复建议

### 通用修补建议

1. 升级至安全版本及其以上。
2. 开启 Gitlab 二次认证。
