# CVE-2025-59037：DuckDB NPM 包供应链投毒事件

## 0x01   漏洞简述

DuckDB 是一个分析型嵌入式 SQL 数据库管理系统。2025 年 9 月 8 日，DuckDB 官方遭遇了一次供应链钓鱼安全攻击，多个 Node.js 相关包被植入恶意代码，攻击者发布了四个包含恶意负载的新版本，包括：@duckdb/node-api@1.3.3、@duckdb/node-bindings@1.3.3、duckdb@1.3.3 和 @duckdb/duckdb-wasm@1.29.2。

这些恶意代码被设计用于干扰加密货币交易，可能对用户资产安全构成潜在威胁。根据 npm 的下载统计数据，这些恶意版本在被删除前未被任何用户下载，因此未造成实际扩散或损害。建议所有用户将相关包升级至 1.3.4 或 1.30.0 及以上版本。如暂时无法升级，也可通过降级至 1.3.2 或 1.29.1 版本来规避风险。

恶意 NPM 包版本：

```
@duckdb/duckdb-wasm 1.29.2
@duckdb/node-api 1.3.3
@duckdb/node-bindings 1.3.3
duckdb 1.3.3
```

## 0x02   风险等级

| 评定方式            | 等级  |
| --------------- | --- |
| 威胁等级            | 高危  |
| 影响面             | 广泛  |
| 攻击者价值           | 高   |
| 利用难度            | 低   |
| CVSS 4.0/3.x 评分 | 8.1 |

## 0x03   漏洞详情

### 披露时间

2025-09-10

### 参考链接

- https://github.com/duckdb/duckdb-node/releases/tag/v1.3.4
- https://github.com/duckdb/duckdb-node/security/advisories/GHSA-w62p-hx95-gf2c
- https://www.aikido.dev/blog/npm-debug-and-chalk-packages-compromised

## 0x04   修复建议

### 通用修补建议

升级相关包至最新版本或者降低至安全版本。
