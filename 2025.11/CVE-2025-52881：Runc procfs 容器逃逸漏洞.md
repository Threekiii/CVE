# CVE-2025-52881：Runc procfs 容器逃逸漏洞

## 0x01   漏洞简述

runc 是一个 CLI 工具，用于根据 OCI 规范生成和运行容器。在 1.2.7、1.3.2 和 1.4.0-rc.2 版本中，攻击者可以通过使用具有共享挂载的竞争容器来诱骗 runc 将对/proc 的写入错误地指向其他 procfs 文件，结合其他漏洞可以导致容器逃逸。

社区版本影响范围：

```
runc v1.2.7 及更早版本
runc v1.3.2 及更早版本
runc v1.4.0-rc.2 及更早版本
```

社区在下列版本中修复了该问题：

```
runc v1.2.8
runc v1.3.3
runc v1.4.0-rc.3
```

## 0x02   风险等级

| 评定方式            | 等级  |
| --------------- | --- |
| 威胁等级            | 高危  |
| 影响面             | 广泛  |
| 攻击者价值           | 高   |
| 利用难度            | 高   |
| CVSS 4.0/3.x 评分 | 7.1 |

## 0x03   漏洞详情

### 披露时间

2025-11-07

### 参考链接

- http://github.com/opencontainers/runc/commit/a41366e74080fa9f26a2cd3544e2801449697322
- http://github.com/opencontainers/runc/commit/fdcc9d3cad2f85954a241ccb910a61aaa1ef47f3
- https://github.com/opencontainers/runc/blob/v1.4.0-rc.2/RELEASES.md
- https://github.com/opencontainers/runc/commit/3f925525b44d247e390e529e772a0dc0c0bc3557
- https://github.com/opencontainers/runc/commit/435cc81be6b79cdec73b4002c0dae549b2f6ae6d
- https://github.com/opencontainers/runc/commit/44a0fcf685db051c80b8c269812bb177f5802c58
- https://github.com/opencontainers/runc/commit/4b37cd93f86e72feac866442988b549b5b7bf3e6
- https://github.com/opencontainers/runc/commit/6fc191449109ea14bb7d61238f24a33fe08c651f
- https://github.com/opencontainers/runc/commit/77889b56db939c323d29d1130f28f9aea2edb544
- https://github.com/opencontainers/runc/commit/77d217c7c3775d8ca5af89e477e81568ef4572db
- https://github.com/opencontainers/runc/commit/b3dd1bc562ed9996d1a0f249e056c16624046d28
- https://github.com/opencontainers/runc/commit/d40b3439a9614a86e87b81a94c6811ec6fa2d7d2
- https://github.com/opencontainers/runc/commit/d61fd29d854b416feaaf128bf650325cd2182165
- https://github.com/opencontainers/runc/commit/db19bbed5348847da433faa9d69e9f90192bfa64
- https://github.com/opencontainers/runc/commit/ed6b1693b8b3ae7eb0250a7e76fc888cdacf98c1
- https://github.com/opencontainers/runc/commit/ff6fe1324663538167eca8b3d3eec61e1bd4fa51
- https://github.com/opencontainers/runc/commit/ff94f9991bd32076c871ef0ad8bc1b763458e480
- https://github.com/opencontainers/runc/security/advisories/GHSA-9493-h29p-rfm2
- https://github.com/opencontainers/runc/security/advisories/GHSA-cgrx-mc8f-2prm
- https://github.com/opencontainers/runc/security/advisories/GHSA-qw9x-cqr3-wc7r

## 0x04   修复建议

### 通用修补建议

1. 官方已经发布安全更新，建议升级至最新版。通过操作系统包管理器安装的 Runc 或者容器相关依赖等请根据上游操作系统发布的具体安全包版本为准。
2. 临时缓解方案：
	- 方案一：使用 rootless 容器。rootless 模式下，runc 将以非 root 的低权限身份运行，可有效阻止大多数针对宿主机 procfs 文件的恶意写入攻击。
	- 方案二：限制使用可信镜像。通过启用安全策略管理中的 ACKAllowedRepos 策略，限制集群只允许使用来自可信镜像仓库的镜像。同时，基于最小化权限原则确保仅可信人员拥有导入镜像的权限。或者通过使用 Notation 和 Ratify 进行 OCI 制品的加签和验签，确保容器镜像的供应链安全。
	- 方案三：加固 LSM 策略。若正在使用 AppArmor 或 SELinux，请确保安全策略已覆盖关键系统路径，限制不必要的访问。但 CVE-2025-52881 仍可能绕过部分 LSM 保护，建议及时升级运行时版本。
