# CVE-2025-31133：Runc masked path 条件竞争容器逃逸漏洞

## 0x01   漏洞简述

该漏洞利用 runc 中 maskedPaths（路径掩码）实现机制的一个缺陷。攻击者可在特定条件下，将容器内的 /dev/null 替换为一个指向宿主机 /proc 目录下敏感文件的符号链接（symlink）。这可能导致关键系统文件被意外挂载为可写，从而被攻击者利用实现容器逃逸。此外，如果攻击者删除 /dev/null，runc 的错误处理逻辑可能导致敏感内核信息泄露。

社区版本影响范围：

```
runc v1.2.7 及更早版本
runc v1.3.2 及更早版本
runc v1.4.0-rc.2 及更早版本
```

社区在下列版本中修复了该问题：

```
runc v1.2.8
runc v1.3.3
runc v1.4.0-rc.3
```

## 0x02   风险等级

| 评定方式            | 等级  |
| --------------- | --- |
| 威胁等级            | 高危  |
| 影响面             | 广泛  |
| 攻击者价值           | 高   |
| 利用难度            | 高   |
| CVSS 4.0/3.x 评分 | 7.5 |

## 0x03   漏洞详情

### 披露时间

2025-11-07

### 参考链接

- https://github.com/opencontainers/runc/commit/1a30a8f3d921acbbb6a4bb7e99da2c05f8d48522
- https://github.com/opencontainers/runc/commit/5d7b2424072449872d1cd0c937f2ca25f418eb66
- https://github.com/opencontainers/runc/commit/8476df83b534a2522b878c0507b3491def48db9f
- https://github.com/opencontainers/runc/commit/db19bbed5348847da433faa9d69e9f90192bfa64
- https://github.com/opencontainers/runc/security/advisories/GHSA-9493-h29p-rfm2
- https://help.aliyun.com/zh/ack/product-overview/security-advisory-for-cve-2025-31133-cve-2025-52565-and-cve-2025-52881

## 0x04   修复建议

### 通用修补建议

1. 官方已经发布安全更新，建议升级至最新版。通过操作系统包管理器安装的 Runc 或者容器相关依赖等请根据上游操作系统发布的具体安全包版本为准。
2. 临时缓解方案：
	- 方案一：使用 rootless 容器。rootless 模式下，runc 将以非 root 的低权限身份运行，可有效阻止大多数针对宿主机 procfs 文件的恶意写入攻击。
	- 方案二：限制使用可信镜像。通过启用安全策略管理中的 ACKAllowedRepos 策略，限制集群只允许使用来自可信镜像仓库的镜像。同时，基于最小化权限原则确保仅可信人员拥有导入镜像的权限。或者通过使用 Notation 和 Ratify 进行 OCI 制品的加签和验签，确保容器镜像的供应链安全。
	- 方案三：加固 LSM 策略。若正在使用 AppArmor 或 SELinux，请确保安全策略已覆盖关键系统路径，限制不必要的访问。但 CVE-2025-52881 仍可能绕过部分 LSM 保护，建议及时升级运行时版本。
