# CVE-2024-21626：runc容器逃逸漏洞通告

报告编号：CERT-R-2024-676

更新日期：2024-02-01

## 0x01   漏洞简述

2024年02月01日，360CERT监测发现`runc`发布了`runc`的风险通告，漏洞编号为`CVE-2024-21626`，漏洞等级：`严重`，漏洞评分：`8.6`。

`runc`是一个 CLI 工具，用于根据 OCI 规范在 Linux 上生成和运行容器。

## 0x02   风险等级

该漏洞的评定结果如下

|评定方式|等级|
|---|---|
|威胁等级|严重|
|影响面|广泛|
|攻击者价值|高|
|利用难度|高|
|360CERT评分|8.6|

## 0x03   漏洞详情

### CVE-2024-21626 容器逃逸漏洞

组件: runc:runc

漏洞类型: 程序逻辑错误

实际影响: 容器逃逸

主要影响: 服务器接管

简述: 该漏洞存在于CLI 工具runc中，是一个容器逃逸漏洞。（以下为攻击手法2）由于内部文件描述符泄漏，攻击者可能会导致新生成的容器进程（来自 runc exec）在主机文件系统命名空间中拥有一个工作目录，从而允许通过授予访问权限来逃逸容器到主机文件系统。（以下为攻击手法1）恶意映像可以使用相同的攻击来允许容器进程通过 runc run 访问主机文件系统。攻击手法 1 和 2 的变体也可用于覆盖半任意主机二进制文件，从而允许完整的容器逃逸。这些漏洞的利用对云原生开发者来说可能会危及整个Docker或Kubernetes主机系统。

## 0x04   影响版本

### CVE-2024-21626

|组件|影响版本|安全版本|
|---|---|---|
|runc:runc|v1.0.0-rc93 ~ 1.1.11|>= 1.1.12|

## 0x05   修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`，或直接访问参考链接获取官方更新指南。
