# CVE-2022-43396/44621：Apache Kylin命令注入漏洞通告

报告编号：B6-2023-010401

更新日期：2023-01-04

## 0x01  漏洞简述

2023年01月04日，360CERT监测发现2个`Apache Kylin 命令注入漏洞`的漏洞细节在互联网公开，漏洞编号为`CVE-2022-43396,CVE-2022-44621`，漏洞等级：`严重`，漏洞评分：`9.8`。

Apache Kylin™是一个开源的分布式分析引擎，提供Hadoop之上的SQL查询接口及多维分析（OLAP）能力以支持超大规模数据，最初由eBay Inc. 开发并贡献至开源社区。它能在亚秒内查询巨大的Hive表。

## 0x02  风险等级

该漏洞的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 严重 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 9.8  |

## 0x03  漏洞详情

### CVE-2022-43396: 命令注入漏洞

CVE: CVE-2022-43396

组件: Kylin

漏洞类型: 命令注入

影响: 服务器接管

简述: 该漏洞存在于Apache Kylin中，是一个命令注入漏洞。原因在 CVE-2022-24697 的修复中的黑名单并不完善，攻击者通过绕过该黑名单中的限制内容即可发起攻击。该漏洞允许攻击者通过kylin.engine.spark-cmd参数来执行恶意命令并接管服务器。

### CVE-2022-44621: 命令注入漏洞

CVE: CVE-2022-44621

组件: Kylin

漏洞类型: 命令注入

影响: 服务器接管

简述: 该漏洞存在于Apache Kylin中，是一个命令注入漏洞。由于系统Controller未验证参数，攻击者可以通过HTTP Request 进行命令注入攻击。

## 0x04  影响版本

| 组件         | 影响版本              | 安全版本 |
| ------------ | --------------------- | -------- |
| Apache Kylin | 2.x，3.x，4.x < 4.0.3 | >= 4.0.3 |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`.

下载链接：https://kylin.apache.org/

补丁链接：https://github.com/apache/kylin/pull/2011