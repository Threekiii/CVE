# CVE-2023-29017：vm2沙箱逃逸漏洞通告

报告编号：CERT-R-2023-89

更新日期：2023-04-10

## 0x01  漏洞简述

2023年04月10日，360CERT监测发现`vm2`发布了`vm2`的风险通告，漏洞编号为`CVE-2023-29017`，漏洞等级：`严重`，漏洞评分：`10`。

vm2是nodejs 实现的一个沙箱环境，一般用于测试不受信任的 JavaScript 代码。

## 0x02  风险等级

该漏洞的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 严重 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 10   |

## 0x03  漏洞详情

### CVE-2023-29017 任意代码执行漏洞

组件: nodejs:vm2

漏洞类型: 程序逻辑错误

实际影响: 任意代码执行, 虚拟环境逃逸

主要影响: 设备完全控制

简述: 该漏洞存在于vm2版本3.9.15之前，是一个沙箱逃逸漏洞。当发生异步错误时，vm2无法正确处理传递给“Error.prepareStackTrace”函数的宿主对象，攻击者成功利用该漏洞可绕过沙箱保护，并在运行沙箱的主机上远程执行代码。

## 0x04  影响版本

### CVE-2023-29017

| 组件 | 影响版本  | 安全版本 |
| ---- | --------- | -------- |
| vm2  | <= 3.9.14 | 3.9.15   |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`，或直接访问参考链接获取官方更新指南。

## 0x06 Poc（for reference only）

- https://github.com/timb-machine-mirrors/seongil-wi-CVE-2023-29017
- https://github.com/Kaneki-hash/CVE-2023-29017-reverse-shell