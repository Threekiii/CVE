# CVE-2023-25725：HAProxy请求走私漏洞通告

报告编号：B6-2023-021701

更新日期：2023-02-17

## 0x01  漏洞简述

2023年02月17日，360CERT监测发现`HAProxy官方`发布了`HAProxy请求走私漏洞`的风险通告，漏洞编号为`CVE-2023-25725`，漏洞等级：`高危`，漏洞评分：`7.5`。

HAProxy 是一种广泛使用的开源负载平衡器和基于 TCP 和 HTTP 的应用程序的反向代理。

## 0x02  风险等级

该漏洞的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 高危 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 7.5  |

## 0x03  漏洞详情

### CVE-2023-25725: HAProxy请求走私漏洞

CVE: CVE-2023-25725

组件: HAProxy

漏洞类型: 请求走私

影响: 数据泄露

简述: 该漏洞存在于HAProxy中，是一个请求走私漏洞。 因为 HTTP/1 标头在某些情况下会无意中丢失，攻击者可利用该漏洞绕过 HAProxy 的标头处理，进而通过恶意设计的 HTTP 请求将 HTTP 请求走私到后端服务器，从而绕过安全控制并未经授权访问敏感数据。

## 0x04  影响版本

| 组件                                             | 影响版本                     | 安全版本                |
| ------------------------------------------------ | ---------------------------- | ----------------------- |
| HAProxy                                          | 2.0 < 2.0.31                 | >= 2.0.31               |
| HAProxy                                          | 2.2 < 2.2.29                 | >= 2.2.29               |
| HAProxy                                          | 2.4 < 2.4.22                 | >= 2.4.22               |
| HAProxy                                          | 2.5 < 2.5.12                 | >= 2.5.12               |
| HAProxy                                          | 2.6 < 2.6.9                  | >= 2.6.9                |
| HAProxy                                          | 2.7 < 2.7.3                  | >= 2.7.3                |
| HAProxy Enterprise                               | 2.0r1 < 2.0r1-1.0.0-248.1534 | >= 2.0r1-1.0.0-248.1534 |
| HAProxy Enterprise                               | 2.2r1 < 2.2r1-1.0.0-254.929  | >= 2.2r1-1.0.0-254.929  |
| HAProxy Enterprise                               | 2.4r1 < 2.4r1-1.0.0-285.1010 | >= 2.4r1-1.0.0-285.1010 |
| HAProxy Enterprise                               | 2.5r1 < 2.5r1-1.0.0-285.653  | >= 2.5r1-1.0.0-285.653  |
| HAProxy Enterprise                               | 2.6r1 < 2.6r1-1.0.0-288.770  | >= 2.6r1-1.0.0-288.770  |
| HAProxy ALOHA                                    | 12.5 < 12.5.18               | >= 12.5.18              |
| HAProxy ALOHA                                    | 13.5 < 13.5.19               | >= 13.5.19              |
| HAProxy ALOHA                                    | 14.0 < 14.0.11               | >= 14.0.11              |
| HAProxy ALOHA                                    | 14.5 < 14.5.6                | >= 14.5.6               |
| HAProxy Kubernetes Ingress Controller            | 1.7 < 1.7.12                 | >= 1.7.12               |
| HAProxy Kubernetes Ingress Controller            | 1.8 < 1.8.1                  | >= 1.8.11               |
| HAProxy Kubernetes Ingress Controller            | 1.9 < 1.9.3                  | >= 1.9.3                |
| HAProxy Enterprise Kubernetes Ingress Controller | 1.7 < 1.7.12                 | >= 1.7.12               |
| HAProxy Enterprise Kubernetes Ingress Controller | 1.8 < 1.8.11                 | >= 1.8.11               |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`.

HAProxy Enterprise 用户可以按照此处的升级说明进行操作：https://www.haproxy.com/documentation/hapee/latest/getting-started/upgrade/linux/#update-haproxy-enterprise

HAProxy ALOHA 用户可以按照此处的升级说明进行操作：https://www.haproxy.com/documentation/aloha/latest/getting-started/firmware-updates/

要将 HAProxy Enterprise 升级为 Docker 容器，请按照此处的说明进行操作：https://www.haproxy.com/documentation/hapee/latest/getting-started/upgrade/docker/