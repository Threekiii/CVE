# CVE-2023-22482/22736：Argo CD 身份验证绕过漏洞通告

报告编号：B6-2023-020101

更新日期：2023-02-01

## 0x01  漏洞简述

2023年02月01日，360CERT监测发现`Argo CD官方`发布了`Argo CD`的风险通告，漏洞编号为`CVE-2023-22482,CVE-2023-22736`，漏洞等级：`高危`，漏洞评分：`9.0`。

Argo CD 是用于 Kubernetes 的声明式 GitOps 持续交付工具。

## 0x02  风险等级

该漏洞的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 高危 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 9.0  |

## 0x03  漏洞详情

### CVE-2023-22482: Argo CD 身份验证绕过漏洞

CVE: CVE-2023-22482

组件: Argo CD

漏洞类型: 身份验证绕过

影响: 身份验证绕过

简述: 漏洞存在于Argo CD中，是一个身份验证绕过漏洞。Argo CD错误的接受了某些非预期令牌，原因是Argo使用的OIDC标准在已签名的令牌中包含一个“aud”声明，该声明的值指定了令牌的预期受众。Argo CD 在受影响的版本只验证了令牌是否由 Argo CD 配置的 OIDC 提供，并没有根据OIDC规范验证 aud 字段，进而导致如果攻击者持有对应OIDC的签发的其他令牌，即可利用该令牌完成对Argo CD 的访问并导致身份验证绕过。

### CVE-2023-22736: Argo CD 身份验证绕过漏洞

CVE: CVE-2023-22736

组件: Argo CD

漏洞类型: 权限绕过

影响: 权限绕过

简述: 该漏洞存在于Argo CD中，是一个权限绕过漏洞。在Argo CD解释以逗号分隔的命名空间列表时，由于逻辑错误而产生此漏洞，导致具有Argo CD访问控制权限的攻击者可以在原本不允许的命名空间内创建容器。

## 0x04  影响版本

### CVE-2023-22482

| 组件    | 影响版本          | 安全版本          |
| ------- | ----------------- | ----------------- |
| Argo CD | 1.8.2 ~ 2.6.0-rc4 | >= 2.6.0-rc5      |
| Argo CD | v2.5.x <= v2.5.6  | v2.5.x >= v2.5.8  |
| Argo CD | v2.4.x <= v2.4.18 | v2.4.x >= v2.4.20 |
| Argo CD | v2.3.x <= v2.3.13 | v2.3.x >= v2.3.14 |

### CVE-2023-22736

| 组件    | 影响版本             | 安全版本             |
| ------- | -------------------- | -------------------- |
| Argo CD | 2.5.0-rc1 ~ 2.5.7    | 2.5.x >= 2.5.8       |
| Argo CD | 2.6.0-x <= 2.6.0-rc4 | 2.6.0-x >= 2.6.0-rc5 |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`。