# CVE-2023-24998：Apache Commons FileUpload拒绝服务漏洞通告

报告编号：B6-2023-022102

更新日期：2023-02-21

## 0x01  漏洞简述

2023年02月21日，360CERT监测发现`Apache官方`发布了`Apache Commons FileUpload拒绝服务漏洞`的风险通告，漏洞编号为`CVE-2023-24998`，漏洞等级：`中危`，漏洞评分：`6.5`。

Apache Commons是一个专注于可重用Java组件开发的 Apache 项目，该项目由Commons Proper、The Commons Sandbox和The Commons Dormant三个部分组成。Apache Commons-FileUpload是Commons Proper中的一个组件，旨在实现文件上传。

## 0x02  风险等级

该漏洞的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 中危 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 6.5  |

## 0x03  漏洞详情

### CVE-2023-24998: Apache Commons FileUpload拒绝服务漏洞

CVE: CVE-2023-24998

组件: Commons FileUpload

漏洞类型: 拒绝服务

影响: 拒绝服务

简述: 该漏洞存在于Apache Commons FileUpload中，是一个拒绝服务漏洞。由于Apache Commons FileUpload 未限制要处理的请求部分的数量，导致攻击者可以通过恶意上传或一系列上传来触发拒绝服务。

## 0x04  影响版本

| 组件                      | 影响版本           | 安全版本     |
| ------------------------- | ------------------ | ------------ |
| Apache Commons FileUpload | 1.0-beta-1 - 1.4   | >= 1.5       |
| Apache Tomcat             | 11.0.0-M1          | >= 11.0.0-M3 |
| Apache Tomcat             | 10.1.0-M1 - 10.1.4 | >= 10.1.5    |
| Apache Tomcat             | 9.0.0-M1 - 9.0.70  | >= 9.0.71    |
| Apache Tomcat             | 8.5.0 - 8.5.84     | >= 8.5.85    |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`

下载链接：

Apache Commons FileUpload：

https://commons.apache.org/proper/commons-fileupload/download_fileupload.cgi

Apache Tomcat:

https://tomcat.apache.org/index.html

## 0x06 Poc（for reference only）

- https://github.com/nice1st/CVE-2023-24998