# CVE-2021-42756/CVE-2022-39952：Fortinet 多个漏洞通告

报告编号：B6-2023-022001

更新日期：2023-02-20

## 0x01  漏洞简述

2023年02月20日，360CERT监测发现`Fortinet`发布了`Fortinet FortiWeb Proxyd缓冲区溢出漏洞`和`Fortinet FortiNAC keyUpload脚本外部控制漏洞`的风险通告，漏洞编号为`CVE-2021-42756、CVE-2022-39952`，漏洞等级：`严重`，漏洞评分：`9.8`。

FortiWeb 是一种 Web 应用程序防火墙 (WAF) 解决方案，旨在保护 Web 应用程序和 API 免受跨站点脚本 (XSS)、SQL注入、DDoS（分布式拒绝服务）和其它攻击。FortiNAC 是一种网络访问控制解决方案，可帮助企业获得实时网络可见性、执行安全策略，并检测和缓解威胁。

## 0x02  风险等级

该漏洞的评定结果如下

| 评定方式    | 等级 |
| ----------- | ---- |
| 威胁等级    | 严重 |
| 影响面      | 广泛 |
| 攻击者价值  | 高   |
| 利用难度    | 低   |
| 360CERT评分 | 9.8  |

## 0x03  漏洞详情

### CVE-2021-42756: Fortinet FortiWeb Proxyd缓冲区溢出漏洞

CVE: CVE-2021-42756

组件: Fortinet FortiWeb Proxyd

漏洞类型: 缓冲区或栈溢出

影响: 代码执行

简述: 该漏洞存在于FortiWeb 代理守护程序中，是一个基于堆栈的缓冲区溢出漏洞，未经身份验证的远程攻击者可以通过特制的 HTTP 请求执行任意代码。

### CVE-2022-39952：Fortinet FortiNAC keyUpload脚本外部控制漏洞

CVE: CVE-2022-39952

组件: Fortinet FortiNAC keyUpload

漏洞类型: 脚本外部控制

影响: 代码执行

简述: 该漏洞存在于Fortinet FortiNAC keyUpload 中，是一个脚本外部控制漏洞，未经身份验证的远程攻击者可以通过特制的 HTTP 请求执行任意代码。

## 0x04  影响版本

| 组件     | 影响版本      | 安全版本  |
| -------- | ------------- | --------- |
| FortiWeb | 5.x           | -         |
| FortiWeb | <= 6.0.7      | >= 6.0.8  |
| FortiWeb | <= 6.1.2      | >= 6.1.3  |
| FortiWeb | <= 6.2.6      | >= 6.2.7  |
| FortiWeb | <= 6.3.16     | >= 6.3.17 |
| FortiWeb | 6.4           | >= 7.0.0  |
| FortiNAC | 9.4.0         | >= 9.4.1  |
| FortiNAC | 9.2.0 - 9.2.5 | >= 9.2.6  |
| FortiNAC | 9.1.0 - 9.1.7 | >= 9.1.8  |
| FortiNAC | 8.3 - 8.8     | >= 7.2.0  |

## 0x05  修复建议

### 通用修补建议

根据`影响版本`中的信息，排查并升级到`安全版本`。

下载链接：https://www.fortinet.com/

## 0x06 Poc（for reference only）

- https://github.com/horizon3ai/CVE-2022-39952
- https://github.com/hackingyseguridad/nmap
- https://github.com/shiyeshu/CVE-2022-39952_webshell

